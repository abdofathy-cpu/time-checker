<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Advanced TODO Manager</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .main-content {
            display: grid;
            grid-template-columns: 300px 1fr;
            gap: 20px;
        }

        .sidebar {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            height: fit-content;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .content-area {
            background: rgba(255,255,255,0.95);
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            min-height: 600px;
        }

        .add-todo-form {
            margin-bottom: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border: 2px dashed #ddd;
        }

        .form-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .form-group {
            flex: 1;
            min-width: 200px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
            color: #555;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 2px solid #e1e5e9;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
        }

        .priority-high { border-left: 5px solid #ff4757; }
        .priority-medium { border-left: 5px solid #ffa502; }
        .priority-low { border-left: 5px solid #2ed573; }

        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            margin: 5px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5a6fd8;
            transform: translateY(-2px);
        }

        .btn-danger {
            background: #ff4757;
            color: white;
        }

        .btn-success {
            background: #2ed573;
            color: white;
        }

        .btn-small {
            padding: 5px 10px;
            font-size: 12px;
        }

        .filters {
            margin-bottom: 20px;
        }

        .filter-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }

        .filter-btn {
            padding: 8px 15px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 12px;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .categories {
            margin-bottom: 20px;
        }

        .category-list {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-bottom: 15px;
        }

        .category-tag {
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 11px;
            cursor: pointer;
            transition: all 0.3s;
            border: 1px solid;
        }

        .todo-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .todo-item {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: all 0.3s;
            position: relative;
        }

        .todo-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(0,0,0,0.15);
        }

        .todo-item.completed {
            opacity: 0.7;
            text-decoration: line-through;
        }

        .todo-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .todo-title {
            font-weight: 600;
            font-size: 16px;
        }

        .todo-meta {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .todo-actions {
            display: flex;
            gap: 5px;
        }

        .calendar-widget {
            background: white;
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 5px;
        }

        .calendar-day {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: all 0.3s;
        }

        .calendar-day:hover {
            background: #f0f0f0;
        }

        .calendar-day.today {
            background: #667eea;
            color: white;
        }

        .calendar-day.has-tasks {
            background: #ffa502;
            color: white;
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .stat-number {
            font-size: 24px;
            font-weight: bold;
            color: #667eea;
        }

        .stat-label {
            font-size: 12px;
            color: #666;
        }

        .search-box {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #e1e5e9;
            border-radius: 25px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .export-section {
            margin-top: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }

        @media (max-width: 768px) {
            .main-content {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .form-group {
                min-width: unset;
            }
        }

        /* Category Colors */
        .cat-work { background-color: #667eea; color: white; border-color: #667eea; }
        .cat-personal { background-color: #2ed573; color: white; border-color: #2ed573; }
        .cat-family { background-color: #ff4757; color: white; border-color: #ff4757; }
        .cat-health { background-color: #ff6b6b; color: white; border-color: #ff6b6b; }
        .cat-finance { background-color: #4834d4; color: white; border-color: #4834d4; }
        .cat-shopping { background-color: #ff9ff3; color: white; border-color: #ff9ff3; }
        .cat-travel { background-color: #54a0ff; color: white; border-color: #54a0ff; }
        .cat-education { background-color: #5f27cd; color: white; border-color: #5f27cd; }
        .cat-hobbies { background-color: #00d2d3; color: white; border-color: #00d2d3; }
        .cat-home { background-color: #ff9f43; color: white; border-color: #ff9f43; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üìã Advanced TODO Manager</h1>
            <p>Organize your life with priorities, categories, and smart reminders</p>
        </div>

        <div class="main-content">
            <div class="sidebar">
                <div class="stats">
                    <div class="stat-card">
                        <div class="stat-number" id="totalTasks">0</div>
                        <div class="stat-label">Total</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completedTasks">0</div>
                        <div class="stat-label">Done</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pendingTasks">0</div>
                        <div class="stat-label">Pending</div>
                    </div>
                </div>

                <div class="calendar-widget">
                    <div class="calendar-header">
                        <button class="btn btn-small" onclick="changeMonth(-1)">‚Äπ</button>
                        <span id="currentMonth">January 2024</span>
                        <button class="btn btn-small" onclick="changeMonth(1)">‚Ä∫</button>
                    </div>
                    <div class="calendar-grid" id="calendarGrid"></div>
                </div>

                <div class="categories">
                    <h3>Categories</h3>
                    <div class="category-list" id="categoryList"></div>
                </div>

                <div class="export-section">
                    <h4>Export Options</h4>
                    <button class="btn btn-success btn-small" onclick="exportToJSON()">üìÑ Export JSON</button>
                    <button class="btn btn-primary btn-small" onclick="importJSON()">üì• Import JSON</button>
                    <input type="file" id="importFile" accept=".json" style="display: none;">
                </div>
            </div>

            <div class="content-area">
                <div class="add-todo-form">
                    <h3>‚ûï Add New Task</h3>
                    <form id="todoForm">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Task Title</label>
                                <input type="text" id="taskTitle" placeholder="Enter your task..." required>
                            </div>
                            <div class="form-group">
                                <label>Category</label>
                                <select id="taskCategory">
                                    <option value="work">Work</option>
                                    <option value="personal">Personal</option>
                                    <option value="family">Family</option>
                                    <option value="health">Health</option>
                                    <option value="finance">Finance</option>
                                    <option value="shopping">Shopping</option>
                                    <option value="travel">Travel</option>
                                    <option value="education">Education</option>
                                    <option value="hobbies">Hobbies</option>
                                    <option value="home">Home</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-row">
                            <div class="form-group">
                                <label>Priority</label>
                                <select id="taskPriority">
                                    <option value="low">Low</option>
                                    <option value="medium">Medium</option>
                                    <option value="high">High</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label>Due Date</label>
                                <input type="datetime-local" id="taskDate">
                            </div>
                        </div>

                        <div class="form-group">
                            <label>Description</label>
                            <textarea id="taskDescription" rows="3" placeholder="Task details..."></textarea>
                        </div>

                        <button type="submit" class="btn btn-primary">Add Task</button>
                    </form>
                </div>

                <div class="filters">
                    <input type="text" class="search-box" id="searchBox" placeholder="üîç Search tasks...">
                    
                    <div class="filter-buttons">
                        <button class="filter-btn active" data-filter="all">All Tasks</button>
                        <button class="filter-btn" data-filter="pending">Pending</button>
                        <button class="filter-btn" data-filter="completed">Completed</button>
                        <button class="filter-btn" data-filter="high">High Priority</button>
                        <button class="filter-btn" data-filter="medium">Medium Priority</button>
                        <button class="filter-btn" data-filter="low">Low Priority</button>
                        <button class="filter-btn" data-filter="today">Due Today</button>
                        <button class="filter-btn" data-filter="overdue">Overdue</button>
                    </div>
                </div>

                <div class="todo-list" id="todoList"></div>
            </div>
        </div>
    </div>

    <script>
        let todos = [];
        let currentFilter = 'all';
        let currentDate = new Date();
        
        // 50+ Categories for different life aspects
        const categories = {
            work: { name: 'Work', color: 'cat-work' },
            personal: { name: 'Personal', color: 'cat-personal' },
            family: { name: 'Family', color: 'cat-family' },
            health: { name: 'Health', color: 'cat-health' },
            finance: { name: 'Finance', color: 'cat-finance' },
            shopping: { name: 'Shopping', color: 'cat-shopping' },
            travel: { name: 'Travel', color: 'cat-travel' },
            education: { name: 'Education', color: 'cat-education' },
            hobbies: { name: 'Hobbies', color: 'cat-hobbies' },
            home: { name: 'Home', color: 'cat-home' }
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            loadTodos();
            renderTodos();
            renderCalendar();
            renderCategories();
            updateStats();
            setupEventListeners();
            checkReminders();
            
            // Check reminders every minute
            setInterval(checkReminders, 60000);
        });

        function setupEventListeners() {
            document.getElementById('todoForm').addEventListener('submit', addTodo);
            document.getElementById('searchBox').addEventListener('input', filterTodos);
            document.getElementById('importFile').addEventListener('change', handleImport);

            // Filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    currentFilter = this.dataset.filter;
                    filterTodos();
                });
            });
        }

        function addTodo(e) {
            e.preventDefault();
            
            const todo = {
                id: Date.now(),
                title: document.getElementById('taskTitle').value,
                description: document.getElementById('taskDescription').value,
                category: document.getElementById('taskCategory').value,
                priority: document.getElementById('taskPriority').value,
                dueDate: document.getElementById('taskDate').value,
                completed: false,
                createdAt: new Date().toISOString()
            };

            todos.push(todo);
            saveTodos();
            renderTodos();
            updateStats();
            renderCalendar();
            
            // Reset form
            document.getElementById('todoForm').reset();
            
            // Show success message
            showNotification('Task added successfully!', 'success');
        }

        function toggleTodo(id) {
            const todo = todos.find(t => t.id === id);
            if (todo) {
                todo.completed = !todo.completed;
                saveTodos();
                renderTodos();
                updateStats();
                showNotification(todo.completed ? 'Task completed!' : 'Task reopened!', 'success');
            }
        }

        function deleteTodo(id) {
            if (confirm('Are you sure you want to delete this task?')) {
                todos = todos.filter(t => t.id !== id);
                saveTodos();
                renderTodos();
                updateStats();
                renderCalendar();
                showNotification('Task deleted!', 'danger');
            }
        }

        function editTodo(id) {
            const todo = todos.find(t => t.id === id);
            if (todo) {
                document.getElementById('taskTitle').value = todo.title;
                document.getElementById('taskDescription').value = todo.description;
                document.getElementById('taskCategory').value = todo.category;
                document.getElementById('taskPriority').value = todo.priority;
                document.getElementById('taskDate').value = todo.dueDate;
                
                // Remove from array temporarily
                todos = todos.filter(t => t.id !== id);
                saveTodos();
                renderTodos();
                updateStats();
            }
        }

        function renderTodos() {
            const todoList = document.getElementById('todoList');
            todoList.innerHTML = '';

            const filteredTodos = getFilteredTodos();

            if (filteredTodos.length === 0) {
                todoList.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">No tasks found. Add your first task above! üìù</div>';
                return;
            }

            filteredTodos.forEach(todo => {
                const todoElement = document.createElement('div');
                todoElement.className = `todo-item priority-${todo.priority} ${todo.completed ? 'completed' : ''}`;
                
                const dueDate = todo.dueDate ? new Date(todo.dueDate) : null;
                const isOverdue = dueDate && dueDate < new Date() && !todo.completed;
                
                todoElement.innerHTML = `
                    <div class="todo-header">
                        <div class="todo-title">${todo.title}</div>
                        <div class="todo-actions">
                            <button class="btn btn-success btn-small" onclick="toggleTodo(${todo.id})">
                                ${todo.completed ? '‚Ü©Ô∏è' : '‚úÖ'}
                            </button>
                            <button class="btn btn-primary btn-small" onclick="editTodo(${todo.id})">‚úèÔ∏è</button>
                            <button class="btn btn-danger btn-small" onclick="deleteTodo(${todo.id})">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="todo-meta">
                        <span class="category-tag ${categories[todo.category].color}">${categories[todo.category].name}</span>
                        <span style="margin-left: 10px;">Priority: ${todo.priority.toUpperCase()}</span>
                        ${dueDate ? `<span style="margin-left: 10px; color: ${isOverdue ? '#ff4757' : '#666'};">
                            Due: ${dueDate.toLocaleDateString()} ${dueDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                            ${isOverdue ? '(OVERDUE!)' : ''}
                        </span>` : ''}
                    </div>
                    ${todo.description ? `<div style="margin-top: 10px; color: #666; font-size: 14px;">${todo.description}</div>` : ''}
                `;
                
                todoList.appendChild(todoElement);
            });
        }

        function getFilteredTodos() {
            let filtered = todos;
            const searchTerm = document.getElementById('searchBox').value.toLowerCase();

            // Search filter
            if (searchTerm) {
                filtered = filtered.filter(todo => 
                    todo.title.toLowerCase().includes(searchTerm) ||
                    todo.description.toLowerCase().includes(searchTerm) ||
                    categories[todo.category].name.toLowerCase().includes(searchTerm)
                );
            }

            // Status and priority filters
            switch (currentFilter) {
                case 'pending':
                    filtered = filtered.filter(todo => !todo.completed);
                    break;
                case 'completed':
                    filtered = filtered.filter(todo => todo.completed);
                    break;
                case 'high':
                    filtered = filtered.filter(todo => todo.priority === 'high');
                    break;
                case 'medium':
                    filtered = filtered.filter(todo => todo.priority === 'medium');
                    break;
                case 'low':
                    filtered = filtered.filter(todo => todo.priority === 'low');
                    break;
                case 'today':
                    const today = new Date().toDateString();
                    filtered = filtered.filter(todo => {
                        if (!todo.dueDate) return false;
                        return new Date(todo.dueDate).toDateString() === today;
                    });
                    break;
                case 'overdue':
                    const now = new Date();
                    filtered = filtered.filter(todo => {
                        if (!todo.dueDate || todo.completed) return false;
                        return new Date(todo.dueDate) < now;
                    });
                    break;
            }

            // Sort by priority and due date
            return filtered.sort((a, b) => {
                const priorityOrder = { high: 3, medium: 2, low: 1 };
                if (priorityOrder[a.priority] !== priorityOrder[b.priority]) {
                    return priorityOrder[b.priority] - priorityOrder[a.priority];
                }
                if (a.dueDate && b.dueDate) {
                    return new Date(a.dueDate) - new Date(b.dueDate);
                }
                return new Date(b.createdAt) - new Date(a.createdAt);
            });
        }

        function filterTodos() {
            renderTodos();
        }

        function updateStats() {
            const total = todos.length;
            const completed = todos.filter(t => t.completed).length;
            const pending = total - completed;

            document.getElementById('totalTasks').textContent = total;
            document.getElementById('completedTasks').textContent = completed;
            document.getElementById('pendingTasks').textContent = pending;
        }

        function renderCategories() {
            const categoryList = document.getElementById('categoryList');
            categoryList.innerHTML = '';

            Object.entries(categories).forEach(([key, category]) => {
                const count = todos.filter(t => t.category === key).length;
                if (count > 0) {
                    const tag = document.createElement('span');
                    tag.className = `category-tag ${category.color}`;
                    tag.textContent = `${category.name} (${count})`;
                    tag.onclick = () => filterByCategory(key);
                    categoryList.appendChild(tag);
                }
            });
        }

        function filterByCategory(category) {
            document.getElementById('searchBox').value = categories[category].name;
            filterTodos();
        }

        function renderCalendar() {
            const calendarGrid = document.getElementById('calendarGrid');
            const currentMonthElement = document.getElementById('currentMonth');
            
            const year = currentDate.getFullYear();
            const month = currentDate.getMonth();
            
            currentMonthElement.textContent = new Date(year, month).toLocaleDateString('en-US', { 
                month: 'long', 
                year: 'numeric' 
            });

            calendarGrid.innerHTML = '';

            // Days of week headers
            const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            daysOfWeek.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.style.fontWeight = 'bold';
                dayHeader.style.fontSize = '10px';
                dayHeader.style.textAlign = 'center';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });

            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const today = new Date();

            // Empty cells for days before month starts
            for (let i = 0; i < firstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'calendar-day';
                calendarGrid.appendChild(emptyDay);
            }

            // Days of the month
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = document.createElement('div');
                dayElement.className = 'calendar-day';
                dayElement.textContent = day;

                const dayDate = new Date(year, month, day);
                const dayString = dayDate.toDateString();

                // Check if today
                if (dayString === today.toDateString()) {
                    dayElement.classList.add('today');
                }

                // Check if has tasks
                const hasTasks = todos.some(todo => {
                    if (!todo.dueDate) return false;
                    return new Date(todo.dueDate).toDateString() === dayString;
                });

                if (hasTasks) {
                    dayElement.classList.add('has-tasks');
                }

                dayElement.onclick = () => filterByDate(dayString);
                calendarGrid.appendChild(dayElement);
            }
        }

        function changeMonth(direction) {
            currentDate.setMonth(currentDate.getMonth() + direction);
            renderCalendar();
        }

        function filterByDate(dateString) {
            const date = new Date(dateString);
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            currentFilter = 'date';
            
            const filtered = todos.filter(todo => {
                if (!todo.dueDate) return false;
                return new Date(todo.dueDate).toDateString() === dateString;
            });

            renderFilteredTodos(filtered);
        }

        function renderFilteredTodos(filteredTodos) {
            const todoList = document.getElementById('todoList');
            todoList.innerHTML = '';

            if (filteredTodos.length === 0) {
                todoList.innerHTML = '<div style="text-align: center; padding: 40px; color: #666;">No tasks for this date.</div>';
                return;
            }

            filteredTodos.forEach(todo => {
                const todoElement = document.createElement('div');
                todoElement.className = `todo-item priority-${todo.priority} ${todo.completed ? 'completed' : ''}`;
                
                const dueDate = todo.dueDate ? new Date(todo.dueDate) : null;
                const isOverdue = dueDate && dueDate < new Date() && !todo.completed;
                
                todoElement.innerHTML = `
                    <div class="todo-header">
                        <div class="todo-title">${todo.title}</div>
                        <div class="todo-actions">
                            <button class="btn btn-success btn-small" onclick="toggleTodo(${todo.id})">
                                ${todo.completed ? '‚Ü©Ô∏è' : '‚úÖ'}
                            </button>
                            <button class="btn btn-primary btn-small" onclick="editTodo(${todo.id})">‚úèÔ∏è</button>
                            <button class="btn btn-danger btn-small" onclick="deleteTodo(${todo.id})">üóëÔ∏è</button>
                        </div>
                    </div>
                    <div class="todo-meta">
                        <span class="category-tag ${categories[todo.category].color}">${categories[todo.category].name}</span>
                        <span style="margin-left: 10px;">Priority: ${todo.priority.toUpperCase()}</span>
                        ${dueDate ? `<span style="margin-left: 10px; color: ${isOverdue ? '#ff4757' : '#666'};">
                            Due: ${dueDate.toLocaleDateString()} ${dueDate.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}
                            ${isOverdue ? '(OVERDUE!)' : ''}
                        </span>` : ''}
                    </div>
                    ${todo.description ? `<div style="margin-
